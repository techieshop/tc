<?php

include("include/function.php");

if ($conn_db != 1) {
  $db = mysql_connect("localhost", "root");
  mysql_select_db("tc2000",$db);
  $conn_db = 1;
}

// w=1480,h=2100
  printf("<html><head>");
  printf("<title>¥N¥X³æ</title>");
  printf("<meta content=\"text/html; charset=big5\" http-equiv=Content-Type>");
  printf("</head><body bgcolor=#ffffff leftMargin=15 topMargin=0 bottomMargin=0 link=#000000 vlink=#000000>");

if (isset($dnid)) {
  $dnid1 = $dnid;
  $dnid2 = $dnid;
}
$dnid1 -= 0;
$dnid2 -= 0;
if ($dnid1 < 10001) {
  $dnid1 = 10001;
}
if ($dnid2 < 10001) {
  $dnid2 = 10001;
}
for ($dnid = $dnid1; $dnid <= $dnid2; $dnid++) {
  printf("<table border=0 cellpadding=0 cellspacing=0 width=500><tr nowrap>");
  printf("<td height=10>&nbsp;</td>");
  printf("</tr></table>");
  printf("<table border=0 cellpadding=0 cellspacing=0 width=500><tr nowrap>");
  printf("<td width=80>");
  printf("<table border=0 cellpadding=0 cellspacing=0 width=100%%><tr nowrap>");
  printf("<td align=center><font>±M&nbsp;&nbsp;Àç</font></td>");
  printf("</tr><tr nowrap>");
  printf("<td align=center><hr size=1 noshade width=40></td>");
  printf("</tr><tr nowrap>");
  printf("<td align=center><font>Àô&nbsp;&nbsp;¹s</font></td>");
  printf("</tr><tr nowrap>");
  printf("<td align=center><font>²y&nbsp;&nbsp;ªf</font></td>");
  printf("</tr><tr nowrap>");
  printf("<td align=center><font>­á&nbsp;&nbsp;§å</font></td>");
  printf("</tr><tr nowrap>");
  printf("<td align=center><font>¦×&nbsp;&nbsp;µo</font></td>");
  printf("</tr></table>");
  printf("</td>");
  printf("<td width=340 height=90>");
  printf("<table border=0 cellpadding=0 cellspacing=0 width=100%%><tr nowrap>");
  printf("<td align=center><font size=+2><b>®õ &nbsp;&nbsp;&nbsp;©÷ &nbsp;&nbsp;&nbsp;¦× &nbsp;&nbsp;&nbsp;­¹ &nbsp;&nbsp;&nbsp;¤½ &nbsp;&nbsp;&nbsp;¥q</b></font></td>");
  printf("</tr><tr nowrap>");
  printf("<td align=center><font size=+2><b>TAI &nbsp;&nbsp;CHEONG &nbsp;&nbsp;MEAT &nbsp;&nbsp;CO.</b></font></td>");
  printf("</tr><tr nowrap>");
  printf("<td align=center><font>¤EÀs²`¤ô–õ¥Õ·¨µó17,19¸¹¦a¤U</font></td>");
  printf("</tr><tr nowrap>");
  printf("<td align=center><font size=-1>G/F., 17, 19A1, Poplar St., Sham Shui Po, Kowloon.</font></td>");
  printf("</tr><tr nowrap>");
  printf("<td align=center><font size=-1>TEL: 2381 8751, 2397 6100 &nbsp;&nbsp;FAX: 2381 8817</font></td>");
  printf("</tr></table>");
  printf("</td>");
  printf("<td width=80>");
  printf("<table border=0 cellpadding=0 cellspacing=0 width=100%%><tr nowrap>");
  printf("<td>&nbsp;</td>");
  printf("</tr></table>");
  printf("</td>");
  printf("</tr></table>");
  printf("<table border=0 cellpadding=0 cellspacing=0 width=500><tr nowrap>");
  printf("<td height=5>&nbsp;</td>");
  printf("</tr><tr nowrap>");
  printf("<td align=left width=100>&nbsp;</td>");
  printf("<td align=center width=300 height=20><font size=+1><b>¥N &nbsp;&nbsp;¥X &nbsp;&nbsp;³æ</b></font></td>");
  printf("<td align=right width=20><font size=+1><b>No. </b></font></td>");
  printf("<td align=right width=60><font size=+1><b>%s</b></font></td>",$dnid);
  printf("<td align=right width=20>&nbsp;</td>");
  printf("</tr><tr nowrap>");
  printf("<td colspan=5 align=center height=5><hr size=1 noshade width=85></td>");
  printf("</tr><tr nowrap>");
  printf("<td height=5>&nbsp;</td>");
  printf("</tr></table>");
  printf("<table border=0 cellpadding=0 cellspacing=0 width=500><tr nowrap>");
  $query = "select customer_name,remark,dn_date from his_reserve_head,ntt_customer where reserve_id='$dnid' and ntt_customer.customer_id=his_reserve_head.customer_id";
  $result = mysql_query($query,$db);
  $myrow = mysql_fetch_array($result);
  printf("<td align=center width=150 height=20><font size=+1><b>%s</b></font></td>",$myrow["customer_name"]);
  printf("<td align=left width=50><font>Ä_¸¹</font></td>");
  $rem = $myrow["remark"];
  printf("<td align=center width=100><font size=+1><b>%s</b></font></td>",$myrow["remark"]);
  $array1 = split("-", $myrow["dn_date"], 4);
  printf("<td align=right width=180><b>%s</b>¦~<b>%s</b>¤ë<b>%s</b>¤é</td>",$array1[0],$array1[1],$array1[2]);
  printf("<td align=right width=20>&nbsp;</td>");
  printf("</tr></table>");
  printf("<table border=0 cellpadding=0 cellspacing=0 width=500><tr nowrap>");
  printf("<td colspan=7 height=10><hr size=1 noshade width=100%%></td>");
  printf("</tr><tr nowrap>");
  printf("<td align=center height=15><font size=-1>³f &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«~</font></td>");
  printf("<td align=right><font size=-1>¥ó¼Æ</font></td>");
  printf("<td align=right><font size=-1>­« &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;¶q</font></td>");
  printf("<td align=right><font size=-1>³æ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;»ù</font></td>");
  printf("<td align=right><font size=-1>ª÷ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ÃB</font></td>");
  printf("</tr><tr nowrap>");
  printf("<td align=center height=15><font size=-1>DESCRIPTION</font></td>");
  printf("<td align=right><font size=-1>QTY</font></td>");
  printf("<td align=right><font size=-1>WEIGHT</font></td>");
  printf("<td align=right><font size=-1>UNIT PRICE</font></td>");
  printf("<td align=right><font size=-1>AMOUNT</font></td>");
  printf("</tr><tr nowrap>");
  printf("<td colspan=7 height=10><hr size=1 noshade width=100%%></td>");
  printf("</tr>");
  $mod_no = 0;
  $query = "select his_reserve_line.*,product_name,product_unit_id from his_reserve_line,vol_product where reserve_id='$dnid' and his_reserve_line.status != '117' and vol_product.product_id=his_reserve_line.product_id";
  $result = mysql_query($query,$db);
  while ($myrow = mysql_fetch_array($result)) {
      $qty = $myrow["qty"]-0;
      $wt = $myrow["weight"]-0;
      $pname = $myrow["product_name"];
      $uni = $myrow["product_unit_id"];
      printf("<tr>");
      printf("<td align=center width=150 height=33><font><b>%s</b></font></td>",$pname);
    if ($qty != 0) {
      printf("<td align=right width=40><font><b>%s</b></font></td>",$qty);
    }
    else {
      printf("<td align=right width=40><font><b>&nbsp;</b></font></td>");
    }
      printf("<td align=right width=90><font><b>%s</b></font></td>",$wt.$uni);
      printf("</tr>");
      $mod_no++;
  }
  for ($i = 0; $i < (12-$mod_no); $i++) {
    printf("<tr>");
    printf("<TD height=33>&nbsp;</TD>");
    printf("</tr>");
  }
    printf("<tr>");
    printf("<td colspan=7 height=10><hr size=1 noshade width=100%%></td>");
    printf("</tr>");
    printf("<tr>");
    printf("<TD>&nbsp;</TD>");
    printf("<TD>&nbsp;</TD>");
    printf("<TD>&nbsp;</TD>");
    printf("<td align=right height=15><font size=-1>¦X &nbsp;&nbsp;&nbsp;­p</font></td>");
    printf("</tr>");
    printf("<tr>");
    printf("<TD>&nbsp;</TD>");
    printf("<TD>&nbsp;</TD>");
    printf("<TD>&nbsp;</TD>");
    printf("<td align=right height=15><font size=-1>TOTAL</font></td>");
    printf("</tr>");
    printf("<tr>");
    printf("<TD>&nbsp;</TD>");
    printf("<TD>&nbsp;</TD>");
    printf("<TD>&nbsp;</TD>");
    printf("<TD>&nbsp;</TD>");
    printf("<td colspan=2 align=right height=10><hr size=2 noshade width=100%%></td>");
    printf("</tr>");
  printf("</TABLE>");
  printf("<table border=0 cellpadding=0 cellspacing=0 width=500><tr nowrap>");
  printf("<td height=60>&nbsp;</td>");
  printf("</tr></table>");
}
  printf("</BODY></HTML>");
  mysql_close($db);

?>
